{% extends 'base.html' %}

{% block title %}Shop{% endblock %}

{% block body %}
    {% include 'popup/settings.html' %}

    <header>
        <button class="nav-button" id="play-button">{{ t("navbar.back_game") }}</button>
        <button class="nav-button" id="settings-button" onclick="OpenPopup('settings-popup')">{{ t("navbar.settings") }}</button>
        <script>
            document.getElementById("play-button").addEventListener("click", () => {
                location.href = "{{ url_for('frontend.main.index') }}";
            });
        </script>
    </header>

    <div class="container" id="shop">
        <section id="item_nav">
            <h2>{{ t("shop.items") }}</h2>
            <ul class="item_list">
                {% for name, item in items.items() %}
                    <li class="item" data-name="{{ name }}" data-image="{{ url_for('static', filename='footage/dice_600x400.webp') }}" data-description="{{ item.description }}" data-price="100">
                        <img src="{{ url_for('static', filename='footage/dice_150x150.webp') }}" alt="{{ item.name }}">
                        <span>{{ item.name }}</span>
                    </li>
                {% endfor %}
            </ul>
        </section>

        <section id="item_show">
            <div id="item_header">
                <div id="points">{{ t("shop.points") }}: {{ current_user.points }}</div>
                <h2>Item Name</h2>
            </div>
            <div id="item_frame">
                <img src="{{ url_for('static', filename='footage/dice_600x400.webp') }}" alt="Item Bild">
            </div>
            <div id="item_description">
                <p>TODO</p>
                <p>{{ t("shop.cost") }}: TODO</p>
                <button class="buy-button" id="buy-button">{{ t("shop.buy") }}</button>
            </div>
        </section>
    </div>


    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const itemNav = document.getElementById("item_nav");
            const itemShow = document.getElementById("item_show");

            itemNav.addEventListener("click", function (event) {
                if (event.target.classList.contains("item")) {
                    const selectedItem = event.target;
                    const itemName = selectedItem.dataset.name;
                    const itemImage = selectedItem.dataset.image;
                    const itemDescription = selectedItem.dataset.description;
                    const itemPrice = selectedItem.dataset.price;

                    const itemHeader = itemShow.querySelector("#item_header");
                    const itemFrame = itemShow.querySelector("#item_frame");
                    const itemDescriptionDiv = itemShow.querySelector("#item_description");

                    itemHeader.querySelector("h2").textContent = itemName;
                    itemFrame.innerHTML = `<img src="${itemImage}" alt="${itemName}">`;
                    itemDescriptionDiv.innerHTML = `
                        <p>${itemDescription}</p>
                        <p>Preis: ${itemPrice} Coins</p>
                        <button class="buy-button" id="buy-button">Kaufen</button>
                    `;
                }
            });
        });
    </script>
{% endblock %}